// ==== ADMIN PANEL SCRIPT ====\n\nconst socket = io();\nconst form = document.getElementById('notifyForm');\nconst titleInput = document.getElementById('title');\nconst messageInput = document.getElementById('message');\nconst targetUserInput = document.getElementById('targetUser');\nconst successMessage = document.getElementById('successMessage');\nconst logList = document.getElementById('logList');\nconst charCountEl = document.getElementById('charCount');\n\nlet sendLog = [];\nlet totalNotifications = 0;\n\n// ====== CONTADOR DE CARACTERES ======\n\nmessageInput.addEventListener('input', () => {\n    charCountEl.textContent = `${messageInput.value.length}/500`;\n});\n\n// ====== ENVIAR NOTIFICA√á√ÉO ======\n\nform.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    const title = titleInput.value.trim();\n    const message = messageInput.value.trim();\n    const targetUser = targetUserInput.value.trim() || null;\n\n    if (!title || !message) {\n        alert('Por favor, preencha T√≠tulo e Mensagem');\n        return;\n    }\n\n    try {\n        const response = await fetch('/api/notify', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                title,\n                message,\n                targetUser: targetUser || undefined\n            })\n        });\n\n        if (response.ok) {\n            const data = await response.json();\n            \n            // Mostrar mensagem de sucesso\n            successMessage.style.display = 'block';\n            setTimeout(() => {\n                successMessage.style.display = 'none';\n            }, 3000);\n\n            // Registrar no hist√≥rico\n            totalNotifications++;\n            addToLog({\n                title,\n                message,\n                targetUser: targetUser || 'TODOS (Broadcast)',\n                timestamp: new Date().toLocaleTimeString('pt-BR')\n            });\n\n            // Limpar formul√°rio\n            form.reset();\n            charCountEl.textContent = '0/500';\n        } else {\n            alert('Erro ao enviar notifica√ß√£o');\n        }\n    } catch (error) {\n        console.error('Erro:', error);\n        alert('Erro de conex√£o ao enviar notifica√ß√£o');\n    }\n});\n\n// ====== ADICIONAR AO HIST√ìRICO DE LOG ======\n\nfunction addToLog(entry) {\n    // Remover \"empty state\" se existir\n    const emptyState = logList.querySelector('.empty-state');\n    if (emptyState) {\n        emptyState.remove();\n    }\n\n    const logItem = document.createElement('div');\n    logItem.className = 'log-item';\n    logItem.innerHTML = `\n        <div class=\"log-header\">\n            <strong>${entry.title}</strong>\n            <span class=\"log-time\">${entry.timestamp}</span>\n        </div>\n        <p class=\"log-message\">${entry.message}</p>\n        <span class=\"log-target\">‚ûú ${entry.targetUser}</span>\n    `;\n\n    logList.insertBefore(logItem, logList.firstChild);\n\n    // Atualizar contadores\n    updateStats();\n}\n\n// ====== ATUALIZAR ESTAT√çSTICAS ======\n\nfunction updateStats() {\n    document.getElementById('totalNotif').textContent = totalNotifications;\n    \n    // Aqui voc√™ poderia contar usu√°rios online via um evento do socket\n    // Por enquanto, usamos um placeholder\n}\n\n// ====== CONECTAR AO SOCKET ======\n\nsocket.on('connect', () => {\n    console.log('‚úÖ Painel Admin conectado');\n});\n\nsocket.on('disconnect', () => {\n    console.log('‚ùå Painel Admin desconectado');\n});\n\n// Mensagem de boas-vindas\nconsole.log('üîê Painel de Administrador Ativo');\nconsole.log('Teste r√°pido: Envie uma notifica√ß√£o e veja em tempo real na aba do usu√°rio');\n